<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Dashboard</title>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script>
            zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
            ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
        </script>
        <style> 
            #myChart,#myChart1,#myChart2,#myChart3, #myChart4 {
                height: 35%;
                width: 35%;
            }
                #myChart-license-text,#myChart1-license-text,#myChart2-license-text,#myChart3-license-text, #myChart4-license-text {
                display:none;
            }
            .radio-container { 
                box-sizing: border-box; 
                font-family: ‘Open Sans’, sans-serif; 
                font-size: 15px; 
                line-height: 32px; 
                margin: 0; 
                margin-left: 120px;
                 outline: 0; 
                overflow: hidden; 
                padding: 0; 
            }
    
    
            .radio-container input { 
                box-sizing: border-box; 
                margin: 0; 
                margin-left: 25px;
                outline: 0; 
                padding: 0; 
                position: relative; 
                top: 9px; 
                vertical-align: top; 
             } 
             td {
                border: 1px solid black;
                padding: 10px;
            }
        </style> 
    </head>
    <body>
        <img style="width: 100px; height: 100px; margin-left: 20px;" src="./static/img/CMAA.png">
        <h3 style="margin-left: 150px; font-weight: bold; margin-top:-90px;">Crabapple Martial Arts Academy-Reporting Dashboard</h3>
        <div class="radio-container"> 
            <input name="red" type="radio" value="red" onclick="rad1();"> 
            Month to Date
           <input name="red" type="radio" value="green" onclick="rad2();"> 
            Year to Date
           <input name="red" type="radio" value="blue" onclick="rad3();"> 
            Custom Date 
           <input id="start" onchange="start(this.value)" style="margin-top: -2px; margin-right: 25px; text-align: center;" type="date">
            to
           <input id="end" onchange="end(this.value)" style="margin-top: -2px; text-align: center;" type="date">
       </div>
       <div>
            <div style="border: 2px solid black; text-align: center; border-bottom: none; width:500px; padding-top: 20px; height: 50px; margin-top: 30px; font-weight: bold; font-size: 30px;">New Lead Acquisition</div>
            <div style="border: 2px solid black; width:500px; height: 300px;" id="piechart"></div>
        </div>
        <div style="font-weight:bold; font-size: 20px; margin-top: 50px; margin-left: 40px;">
            Appointments (Month to Date)
        </div>
        <br>
        <table style="margin-left: 20px; width: 20%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Intro 1</td>
            </tr>
            <tr>
                <td>Intro 1 Appointments Set</td>
                <td id="int11" style="text-align: center;"></td>
            </tr>
            <tr>
                <td>Intro 1 Appointments Showed</td>
                <td id="int12" style="text-align: center;"></td>
            </tr>
        </table>
        <table style="margin-left: 350px; margin-top: -125px; width:10%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Intro 1 Show Rate</td>
            </tr>
            <tr>
                <td id="int13" style="text-align: center; font-weight: bold; margin-right:100px; font-size:25px; padding-top:25px; padding-bottom:25px;"></td>
            </tr>
        </table>
        <br>
        <table style="margin-left: 20px; width: 20%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Intro 2</td>
            </tr>
            <tr>
                <td>Intro 2 Appointments Set</td>
                <td id="int21" style="text-align: center;"></td>
            </tr>
            <tr>
                <td>Intro 2 Appointments Showed</td>
                <td id="int22" style="text-align: center;">60</td>
            </tr>
        </table>
        <table style="margin-left: 350px; margin-top: -125px; width:10%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Intro 2 Show Rate</td>
            </tr>
            <tr>
                <td id="int23" style="text-align: center; font-weight: bold; margin-right:100px; font-size:25px; padding-top:25px; padding-bottom:25px;"></td>
            </tr>
        </table>
        <br>
        <table style="margin-left: 20px; width: 20%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Enrollments</td>
            </tr>
            <tr>
                <td>Enrollment Conferences</td>
                <td id="enr1" style="text-align: center;"></td>
            </tr>
            <tr>
                <td>Enrollments</td>
                <td id="enr2" style="text-align: center;"></td>
            </tr>
        </table>
        <table style="margin-left: 350px; margin-top: -125px; width:10%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Enrollment Rate</td>
            </tr>
            <tr>
                <td  id="enr3" style="text-align: center; font-weight: bold; margin-right:100px; font-size:25px; padding-top:25px; padding-bottom:25px;"></td>
            </tr>
        </table>
        <br>
        <table style="margin-left: 20px; width: 20%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Renewals</td>
            </tr>
            <tr>
                <td>Renewal Conferences</td>
                <td id="ren1" style="text-align: center;"></td>
            </tr>
            <tr>
                <td>Renewals</td>
                <td id="ren2" style="text-align: center;">5</td>
            </tr>
        </table>
        <table style="margin-left: 350px; margin-top: -125px; width:10%;">
            <tr>
                <td style="text-align: center; font-weight: bold; border: none;">Renewal Rate</td>
            </tr>
            <tr>
                <td id="ren3" style="text-align: center; font-weight: bold; margin-right:100px; font-size:25px; padding-top:25px; padding-bottom:25px;"></td>
            </tr>
        </table>
        <div style="margin-left: 600px; margin-top: -1000px">
            <div style="font-size:20px; font-weight: bold; text-align: center; width: 35%;">Net New Enrollments</div>
            <div id='myChart' style="margin-top: -5px; height:250px;"></div>
        </div>
        <div style="margin-left: 600px; margin-top: -4px;">
            <div style="font-size:20px; font-weight: bold; text-align: center; width: 35%;">Leads Conversion Rate</div>
            <div style=" height:250px;" id='myChart1'></div>
        </div>
        <div style="margin-left: 600px; margin-top: -4px;">
            <div style="font-size:20px; font-weight: bold; text-align: center; width: 35%;">Intro 1 Conversion Rate</div>
            <div style=" height:250px;" id='myChart2'></div>
        </div>
        <div style="margin-left: 600px; margin-top: -4px;">
            <div style="font-size:20px; font-weight: bold; text-align: center; width: 35%;">Intro 2 Conversion Rate</div>
            <div style=" height:250px;" id='myChart3'></div>
        </div>        
        <div style="margin-left: 1100px; margin-top: -1080px;">
            <div style="font-weight: bold; font-size: 22px; text-align: center; width: 60%;">Active Student Count</div>
            <br>
            <img src="./static/img/a.JPG">
            <div id="count" style="font-weight: bold; font-size: 30px; margin-left: 130px; margin-top: -50px;"></div>
        </div>
        <div style="margin-left: 1100px; margin-top: 70px;">
            <div style="font-weight: bold; font-size: 22px; text-align: center; width: 60%;">Gross Revenue</div>
            <br>
            <img src="./static/img/b.JPG">
            <div id="gross" style="font-weight: bold; font-size: 30px; margin-left: 130px; margin-top: -50px;"></div>
        </div>
        <div style="margin-left: 1100px;">
            <div style="font-weight: bold; font-size: 22px; margin-top: 70px; width: 70%;">Year to Date Gross Revenue</div>
            <br>
            <img src="./static/img/a.JPG">
            <div id="ygross" style="font-weight: bold; font-size: 30px; margin-left: 130px; margin-top: -50px;"></div>
        </div>
        <div style="margin-left: 1000px; margin-top: 60px;" id='myChart4'></div>
       <script type="text/javascript">
            tables();
            ch();
            function tables() {
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth()+1; //January is 0!
                var yyyy = today.getFullYear();

                if(dd<10) {
                    dd = '0'+dd
                } 

                if(mm<10) {
                    mm = '0'+mm
                } 

                today = yyyy + '-' + mm + '-' + dd;
                var first = yyyy+'-'+mm+'-'+"01";
                var u = '/records_by_date/'+first+'/'+today;
                    $.ajax({
                    url: u,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        document.getElementById("int11").innerHTML = res.total[7].Intro_1[0];
                        document.getElementById("int12").innerHTML = res.total[8].Intro_1_Attended_Showed[0];
                        document.getElementById("int13").innerHTML = ((res.total[8].Intro_1_Attended_Showed[0]/res.total[7].Intro_1[0])*100).toFixed(1)+"%";
                        document.getElementById("int21").innerHTML = res.total[9].Intro_2[0];
                        document.getElementById("int22").innerHTML = res.total[10].Intro_2_Attended_Showed[0];
                        document.getElementById("int23").innerHTML = ((res.total[10].Intro_2_Attended_Showed[0]/res.total[9].Intro_2[0])*100).toFixed(1)+"%";
                        document.getElementById("enr1").innerHTML = res.total[11].Enrollment_Conferences[0];
                        document.getElementById("enr2").innerHTML = res.total[19].no_of_Enrollments[0];
                        document.getElementById("enr3").innerHTML = ((res.total[19].no_of_Enrollments[0]/res.total[11].Enrollment_Conferences[0])*100).toFixed(1)+"%";
                        document.getElementById("ren1").innerHTML = res.total[12].Renewal_Upgrade_Conferences[0];
                        document.getElementById("ren2").innerHTML = res.total[22].no_of_Upgrades_Renewals[0];
                        document.getElementById("ren3").innerHTML = ((res.total[22].no_of_Upgrades_Renewals[0]/res.total[12].Renewal_Upgrade_Conferences[0])*100).toFixed(1)+"%";
                    }
                });
                var first1 = yyyy+'-'+"01"+'-'+"01";
                var u1 = '/records_by_date/'+first1+'/'+today;
                    $.ajax({
                    url: u1,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        document.getElementById("ygross").innerHTML = "$"+res.total[32].Total_Gross_Revenue[0].toFixed(1);
                    }
                });
            }
            var art;
            function charget(m) {
                var today = new Date();
                var yyyy = today.getFullYear();
                $.ajax({
                    url: '/records_by_date/'+yyyy+'-'+m+'-'+'01'+'/'+yyyy+'-'+m+'-'+'30',
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        a(res.total[32].Total_Gross_Revenue[0],m);
                    }
                });
            }
            function ch() {
                charget("01");
                charget("02");
                charget("03");
                charget("04");
                charget("05");
                charget("06");
                charget("07");
                charget("08");
                charget("09");
                charget("10");
                charget("11");
                charget("12");
            }
            var b; var c; var d; var e,f,g,h,i,j,k,l,n;
            function a(a,m) {
                if(m==="01") {
                    b=a;
                }
                else if(m==="02") {
                    c = a;
                }
                else if(m==="03") {
                    d = a;
                }
                else if(m==="04") {
                    e = a;
                }
                else if(m==="05") {
                    f = a;
                }
                else if(m==="06") {
                    g = a;
                }
                else if(m==="07") {
                    h = a;
                }
                else if(m==="08") {
                    i = a;
                }
                else if(m==="09") {
                    j = a;
                }
                else if(m==="10") {
                    k = a;
                }
                else if(m==="11") {
                    l = a;
                }
                else if(m==="12") {
                    n = a;
                } 
                if(b!==undefined &&  c!==undefined &&  d!==undefined &&  e!==undefined &&  f!==undefined &&  g!==undefined &&  h!==undefined &&  i!==undefined &&  j!==undefined &&  k!==undefined &&  l!==undefined && n!==undefined) {
                    console.log(b,c,d,e,f,g,h,i,j,k,l,n);
                    barchart(b,c,d,e,f,g,h,i,j,k,l,n);
                }
            }
            var s = 0;
            var e = 0;
            // Load google charts
            function pie (a,b,c,d,e,f) {
                google.charts.load('current', {'packages':['corechart']});
                google.charts.setOnLoadCallback(drawChart);
                // Draw the chart and set the chart values
                function drawChart() {
                var data = google.visualization.arrayToDataTable([
                    ['Task', 'Hours per Day'],
                    ['Inquiry- Call-In', a],
                    ['Inquiry- Walk-In', b],
                    ['Inquiry- Web', c],
                    ['Inquiry- Special Event', d],
                    ['Inquiry- Referral', e],
                    ['Inquiry- Other', f],
                ]);
                
                // Optional; add a title and set the width and height of the chart
                var options = {'width':500, 'height': 300};
                
                // Display the chart inside the <div> element with id="piechart"
                var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                chart.draw(data, options);
                }
            }
            function gauge11(x) {
                var myConfig2 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart',
                data: myConfig2,
                height: "100%",
                width: "100%"
                });
            } 
            function gauge12(x) {
                var myConfig2 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart',
                data: myConfig2,
                height: "100%",
                width: "100%"
                });
            }
            function gauge13(x) {
                var myConfig2 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart',
                data: myConfig2,
                height: "100%",
                width: "100%"
                });
            }
            function gauge21(x) {
                var myConfig3 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart1',
                data: myConfig3,
                height: "100%",
                width: "100%"
                });
            }
            function gauge22(x) {
                var myConfig3 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart1',
                data: myConfig3,
                height: "100%",
                width: "100%"
                });
            }
            function gauge23(x) {
                var myConfig3 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart1',
                data: myConfig3,
                height: "100%",
                width: "100%"
                });
            }
            function gauge31(x) {
                var myConfig4 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart2',
                data: myConfig4,
                height: "100%",
                width: "100%"
                });
            }
            function gauge32(x) {
                var myConfig4 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart2',
                data: myConfig4,
                height: "100%",
                width: "100%"
                });
            }
            function gauge33(x) {
                var myConfig4 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart2',
                data: myConfig4,
                height: "100%",
                width: "100%"
                });
            }
            function gauge41(x) {
                var myConfig5 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart3',
                data: myConfig5,
                height: "100%",
                width: "100%"
                });
            }
            function gauge42(x) {
                var myConfig5 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart3',
                data: myConfig5,
                height: "100%",
                width: "100%"
                });
            }
            function gauge43(x) {
                var myConfig5 = {
                "type": "gauge",
                "scale-r": {
                    "aperture": 200, //Scale Range
                    "values": "0:100:20" //and minimum, maximum, and step scale values.
                },
                "series": [{
                    "values": [x]
                }]
                };

                zingchart.render({
                id: 'myChart3',
                data: myConfig5,
                height: "100%",
                width: "100%"
                });
            }
            function amount(y) {
                document.getElementById("gross").innerHTML = "$"+y;
            }
            function student(x) {
                document.getElementById("count").innerHTML = x;
            }
            function barchart(a,b,c,d,e,f,g,h,i,j,k,l) {
                var myConfig6 = {
                type: "bar",
                plot: {
                    styles: ["green", "green", "green", "green", "green", "green", "green", "green", "green", "green", "green", "green"],
                },
                "scale-x": {
                "label":{ /* Scale Title */
                },
                "labels":["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"] /* Scale Labels */
                },
                series: [{
                    values: [a, b, c, d, e, f, g, h, i, j, k, l],
                    goals: [25, 35, 30, 55, 11, 40, 30, 30, 11, 40, 30, 30]
                }]
                };

                zingchart.render({
                id: 'myChart4',
                data: myConfig6,
                height: "99.99%",
                width: '99.99%'
                });
            }
            function rad1()
            {
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth()+1;
                var yyyy = today.getFullYear();
                var cc = new Date((new Date(today.getFullYear(), mm, 1)).valueOf() - 86350989);
                yesmon = ("0" + (cc.getMonth() + 1)).slice(-2);
                if(mm===1) {
                    var yes = yyyy+'-'+yesmon+'-'+"01";
                } else {
                    var yes = yyyy+'-'+yesmon+'-'+cc.getDate();   
                }
                console.log(yes);
                if(dd<10) {
                    dd = '0'+dd
                } 

                if(mm<10) {
                    mm = '0'+mm
                } 

                today = yyyy + '-' + mm + '-' + dd;
                var first = yyyy+'-'+mm+'-'+"01";
                var u = '/records_by_date/'+first+'/'+today;
                console.log(u);
                var v = '/records_by_date/'+yyyy+'-01-01'+'/'+yes;
                console.log(v);
                $.ajax({
                    url: u,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        console.log(res);
                        var a = res.total[0].Inquiry_Call_In[0];
                        var b = res.total[1].Inquiry_Walk_In[0];
                        var c = res.total[2].Inquiry_Web[0];
                        var d = res.total[21].Student_Count_2nd_Day[0];
                        var e = res.total[3].Inquiry_Referral[0];
                        var f = res.total[4].Inquiry_Other[0];
                        pie(a,b,c,d,e,f);
                        var g = ((res.total[8].Intro_1_Attended_Showed[0]/res.total[7].Intro_1[0])*100);
                        var h = ((res.total[10].Intro_2_Attended_Showed[0]/res.total[9].Intro_2[0])*100);
                        var i = ((res.total[19].no_of_Enrollments[0]/res.total[11].Enrollment_Conferences[0])*100);
                        var j = ((res.total[22].no_of_Upgrades_Renewals[0]/res.total[12].Renewal_Upgrade_Conferences[0])*100);
                        gauge11(g);
                        gauge21(h);
                        gauge31(i);
                        gauge41(j);
                        amount(res.total[32].Total_Gross_Revenue[0].toFixed(1));
                    }
                });
                $.ajax({
                    url: v,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        stu(res.total[20].Student_Count_1st_Day[0],mm);
                    }
                });
                function stu(aa,mm) {
                    $.ajax({
                    url: u,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        console.log(aa);
                        console.log(res.total[20].Student_Count_1st_Day[0]);
                        if(mm=="01") {
                            var s=148+res.total[20].Student_Count_1st_Day[0];
                        } else {
                            var s=148+aa+res.total[20].Student_Count_1st_Day[0];
                        }
                        student(s);
                    }
                }); 
                }
                document.getElementById('start').disabled = true;
                document.getElementById('end').disabled = true;
            }
            function rad2()
            {
                amount('');
                student('');
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth() + 1;
                var yyyy = today.getFullYear();
                if(dd<10) {
                    dd = '0'+dd
                } 

                if(mm<10) {
                    mm = '0'+mm
                } 

                today = yyyy + '-' + mm + '-' + dd;
                var first = yyyy+'-'+"01"+'-'+"01";
                var u = '/records_by_date/'+first+'/'+today;
                console.log(u);
                    $.ajax({
                    url: u,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        var a = res.total[0].Inquiry_Call_In[0];
                        var b = res.total[1].Inquiry_Walk_In[0];
                        var c = res.total[2].Inquiry_Web[0];
                        var d = res.total[21].Student_Count_2nd_Day[0];
                        var e = res.total[3].Inquiry_Referral[0];
                        var f = res.total[4].Inquiry_Other[0];
                        pie(a,b,c,d,e,f);
                        var g = ((res.total[8].Intro_1_Attended_Showed[0]/res.total[7].Intro_1[0])*100);
                        var h = ((res.total[10].Intro_2_Attended_Showed[0]/res.total[9].Intro_2[0])*100);
                        var i = ((res.total[19].no_of_Enrollments[0]/res.total[11].Enrollment_Conferences[0])*100);
                        var j = ((res.total[22].no_of_Upgrades_Renewals[0]/res.total[12].Renewal_Upgrade_Conferences[0])*100);
                        gauge12(g);
                        gauge22(h);
                        gauge32(i);
                        gauge42(j);
                        amount(res.total[32].Total_Gross_Revenue[0].toFixed(1));
                        var s=148+res.total[20].Student_Count_1st_Day[0];
                        console.log(res.total[20].Student_Count_1st_Day[0]);
                        student(s);
                        amount(res.total[32].Total_Gross_Revenue[0].toFixed(1));
                    }
                });
                document.getElementById('start').disabled = true;
                document.getElementById('end').disabled = true;
            }
            function start(val) {
                s = val;
                construct(s,e);
            }
            function end(val) {
                e = val;
                construct(s,e);
            }
            function rad3()
            {
                document.getElementById('start').disabled = false;
                document.getElementById('end').disabled = false;
                amount('');
                student('');
                pie('','','','','','');
            }
            function construct(s,e) {
                amount('');
                student('');
                pie('','','','','','');
                if (s!==null && e!==null) {
                    s = new Date(s);
                    console.log(s.getMonth()+1);
                    var smon=("0" + (s.getMonth()+1)).slice(-2);
                    var sday=("0" + s.getDate()).slice(-2);
                    var cc = new Date((new Date(s.getFullYear(), smon, sday)).valueOf() - 86350989);
                    console.log(cc);
                    var ccday=("0" + cc.getDate()).slice(-2);
                    var ccmon=("0" + (cc.getMonth())).slice(-2);
                    console.log(ccmon);
                    var yesmon = ("0" + (cc.getMonth())).slice(-2);
                    var yes = s.getFullYear()+'-'+ccmon+'-'+ccday;
                    var u = '/records_by_date/'+s.getFullYear()+'-'+smon+'-'+sday+'/'+e;
                    var v = '/records_by_date/'+s.getFullYear()+'-01-01'+'/'+yes;
                    console.log(u);
                    console.log(v);
                    $.ajax({
                    url: u,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        var a = res.total[0].Inquiry_Call_In[0];
                        var b = res.total[1].Inquiry_Walk_In[0];
                        var c = res.total[2].Inquiry_Web[0];
                        var d = res.total[21].Student_Count_2nd_Day[0];
                        var e = res.total[3].Inquiry_Referral[0];
                        var f = res.total[4].Inquiry_Other[0];
                        pie(a,b,c,d,e,f);
                        var g = ((res.total[8].Intro_1_Attended_Showed[0]/res.total[7].Intro_1[0])*100);
                        var h = ((res.total[10].Intro_2_Attended_Showed[0]/res.total[9].Intro_2[0])*100);
                        var i = ((res.total[11].Enrollment_Conferences[0]/res.total[19].no_of_Enrollments[0])*100);
                        var j = ((res.total[12].Renewal_Upgrade_Conferences[0]/res.total[22].no_of_Upgrades_Renewals[0])*100);
                        gauge13(g);
                        gauge23(h);
                        gauge33(i);
                        gauge43(j);
                        amount(res.total[32].Total_Gross_Revenue[0].toFixed(1));
                    }
                });
                $.ajax({
                    url: v,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        stu(res.total[20].Student_Count_1st_Day[0],sday);
                    }
                });
                function stu(aa,sday) {
                    $.ajax({
                    url: u,
                    type: 'GET',
                    dataType: 'json', // added data type
                    success: function(res) {
                        if(sday==="01" && smon==="01") {
                            var s=148+res.total[20].Student_Count_1st_Day[0];
                        } else {
                            var s=148+aa+res.total[20].Student_Count_1st_Day[0];
                        }
                        student(s);
                    }
                }); 
                }
            }
        }
        </script>
    </body>
</html>